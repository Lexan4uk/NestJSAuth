# NextJS + Prisma + SQLite Авторизации (2 штуки)
## Навигация
- [Первая (простая на jwt)](#первая)  
- [Вторая (сложная на jwt с access и refresh токенами)а](#вторая)
  
## Первая
Бд - prisma, запроса добавления пользователя тут нет, добавьте напрямую через prisma studio. У второй авторизации путь есть, т.к. пароль хэшируется.
Получение пользователя при условии что в header есть bearer jwt, если он подходящий - выполняется запрос на получение пользователя. Токен работает столько, сколько пописано в auth.module.ts - я поставил 1 день.

[![Демо](https://img.youtube.com/vi/2HmnxMyy_94/0.jpg)](https://youtu.be/2HmnxMyy_94)

## Вторая
Есть 2 токена - refreshToken и accessToken. refreshToken - долгоживущий, используется для обновления accessToken, используется в cookie. accessToken - короткоживущий, используется для всех запросов, используется как Bearer в хэдэре запросов. При выходе из аккаунта refreshToken из куки просрочивается и удаляется, на фронтэнде так же надо удалять accessToken из хэдэра.
Получение пользователя происходит кастомным декоратором CurrentUser, который берёт из jwt токена id, выполняет поиск в пользователя в БД по id и возвращает id, username либо и то и другое. Далее, 
в моём случае я просто по полученному айди снова выполняю поиск по базе и вывожу обратно username.
Пароль хэшируется через Argon2.

[![Демо](https://img.youtube.com/vi/zoEz3jdFroE/0.jpg)](https://youtu.be/zoEz3jdFroE)
